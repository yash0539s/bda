import pandas as pd 
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.svm import SVR
from sklearn.tree import DecisionTreeRegressor
from sklearn.neighbors import KNeighborsRegressor
from sklearn.ensemble import RandomForestRegressor
from sklearn.metrics import r2_score,mean_squared_error
from sklearn.preprocessing import StandardScaler



data=pd.read_csv("C:\\Users\\HP\\OneDrive\\Desktop\\BDA\\Synthetic_Graduate_Admissions.csv")
print(data)

data = data.select_dtypes(include=[float, int])

x=data.iloc[:,:-1]
y=data.iloc[:,-1]


x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2)

sc=StandardScaler()
x_train=sc.fit_transform(x_train)
x_test=sc.fit_transform(x_test)

print(x_train)

models = {
    "Linear Regression": LinearRegression(),
    "Decision Tree": DecisionTreeRegressor(random_state=42),
    "Random Forest": RandomForestRegressor(random_state=42),
    "Support Vector Regressor": SVR(),
    "KNN Regressor": KNeighborsRegressor()
}


for name,model in models.items():
    model.fit(x_train,y_train)
    y_pred=model.predict(x_test)
    r2=r2_score(y_test,y_pred)
    mse=np.sqrt(mean_squared_error(y_test,y_pred))
    print(f"{name:25s}  RÂ² = {r2:.3f}   RMSE = {mse:.3f}")
    

best_model = RandomForestRegressor(random_state=42)
best_model.fit(x, y)

# Pick a real example from dataset (e.g., row 5)
real_sample = data.iloc[[4]]  
X_sample = real_sample[['GRE Score', 'TOEFL Score', 'University Rating', 'SOP', 'LOR', 'CGPA', 'Research']]

# Scale and predict
sample_scaled = sc.transform(X_sample)
pred = best_model.predict(sample_scaled)[0]

# Show actual vs predicted
print("\nðŸŽ“ Real Sample Used for Prediction:")
print(X_sample)
print(f"\nâœ… Predicted Chance of Admission: {pred*100:.2f}%")
print(f"ðŸŽ¯ Actual Chance of Admission: {real_sample['Chance of Admit'].values[0]*100:.2f}%")
